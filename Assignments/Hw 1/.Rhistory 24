geom_boxplot(fill = "lightblue") +
labs(title = "PM2.5 Distribution in LA County: 2002 vs 2022",
x = "Year", y = "Daily PM2.5") +
theme_minimal()
la_data$Month <- factor(format(as.Date(la_data$Date), "%m"),
levels = sprintf("%02d", 1:12),
labels = month.abb)
ggplot(la_data, aes(x = Month, y = PM25, group = Year, color = factor(Year))) +
stat_summary(fun = mean, geom = "line", linewidth = 1) +
stat_summary(fun = mean, geom = "point", size = 2) +
labs(title = "Monthly PM2.5 in LA County: 2002 vs 2022",
x = "Month", y = "Mean PM2.5", color = "Year") +
theme_minimal()
ggplot(la_data, aes(x = as.Date(Date), y = PM25, color = factor(Year))) +
geom_line(alpha = 0.4) +
labs(title = "Daily PM2.5 in LA County",
x = "Date", y = "PM2.5", color = "Year") +
theme_minimal()
####
ggplot(la_data, aes(x = PM25, fill = factor(Year))) +
geom_density(alpha = 0.5) +
labs(title = "PM2.5 Density in LA County",
x = "Daily PM2.5", fill = "Year") +
theme_minimal()
####
la_data %>%
count(Year) %>%
ggplot(aes(x = factor(Year), y = n, fill = factor(Year))) +
geom_col() +
labs(title = "Valid PM2.5 Observations in LA County",
x = "Year", y = "Count") +
theme_minimal()
## Summary stats ----
la_data <- combined_data %>%
filter(County == "Los Angeles", PM25 >= 0, !is.na(Date), !is.na(PM25))
#### Basic summary ----
la_data %>%
group_by(Year) %>%
summarise(
count = n(),
mean = mean(PM25),
median = median(PM25),
sd = sd(PM25),
min = min(PM25),
max = max(PM25),
.groups = "drop"
)
#### Extreme value counts ----
la_data %>%
group_by(Year) %>%
summarise(
above_35 = sum(PM25 > 35),
above_55 = sum(PM25 > 55),
above_100 = sum(PM25 > 100),
.groups = "drop"
)
#### Monthly averages ----
la_data %>%
mutate(Month = factor(format(as.Date(Date), "%m"),
levels = sprintf("%02d", 1:12),
labels = month.abb)) %>%
group_by(Year, Month) %>%
summarise(monthly_avg = mean(PM25), .groups = "drop") %>%
arrange(Year, Month) %>%
print(n = Inf)
#### Obs counts ----
la_data %>%
count(Year)
# Filter for California only
ca_data <- combined_data
#### Boxplot of PM2.5 by year ----
ggplot(ca_data, aes(x = factor(Year), y = PM25)) +
geom_boxplot(fill = "lightblue") +
labs(title = "PM2.5 Distribution in California: 2002 vs. 2022",
x = "Year", y = "Daily PM2.5") +
theme_minimal()
#### Line plot of monthly averages ----
ca_data$Date <- as.Date(ca_data$Date)
ca_data$Month <- factor(format(ca_data$Date, "%m"),
levels = sprintf("%02d", 1:12),
labels = month.abb)
ggplot(ca_data, aes(x = Month, y = PM25, group = Year, color = factor(Year))) +
stat_summary(fun = mean, geom = "line", linewidth = 1) +
stat_summary(fun = mean, geom = "point", size = 2) +
labs(title = "Monthly PM2.5 in California: 2002 vs 2022",
x = "Month", y = "Mean PM2.5", color = "Year") +
theme_minimal()
#### Histogram of PM2.5 Values ----
ggplot(ca_data, aes(x = PM25, fill = factor(Year))) +
geom_histogram(binwidth = 2, alpha = 0.6, position = "identity") +
labs(title = "PM2.5 Histogram in California",
x = "Daily PM2.5", fill = "Year") +
theme_minimal()
#### Obs count ----
ca_data %>%
filter(PM25 >= 0) %>%
count(Year) %>%
ggplot(aes(x = factor(Year), y = n, fill = factor(Year))) +
geom_col() +
labs(title = "Valid PM2.5 Observations by Year",
x = "Year", y = "Count") +
theme_minimal()
# Filter for California only
ca_data <- combined_data
#### Boxplot of PM2.5 by year ----
ggplot(ca_data, aes(x = factor(Year), y = PM25)) +
geom_boxplot(fill = "lightblue") +
labs(title = "PM2.5 Distribution in California: 2002 vs. 2022",
x = "Year", y = "Daily PM2.5") +
theme_minimal()
#### Line plot of monthly averages ----
ca_data$Date <- as.Date(ca_data$Date)
ca_data$Month <- factor(format(ca_data$Date, "%m"),
levels = sprintf("%02d", 1:12),
labels = month.abb)
ggplot(ca_data, aes(x = Month, y = PM25, group = Year, color = factor(Year))) +
stat_summary(fun = mean, geom = "line", linewidth = 1) +
stat_summary(fun = mean, geom = "point", size = 2) +
labs(title = "Monthly PM2.5 in California: 2002 vs 2022",
x = "Month", y = "Mean PM2.5", color = "Year") +
theme_minimal()
#### Histogram of PM2.5 Values ----
ggplot(ca_data, aes(x = PM25, fill = factor(Year))) +
geom_histogram(binwidth = 2, alpha = 0.6, position = "identity") +
labs(title = "PM2.5 Histogram in California",
x = "Daily PM2.5", fill = "Year") +
theme_minimal()
#### Obs count ----
ca_data %>%
filter(PM25 >= 0) %>%
count(Year) %>%
ggplot(aes(x = factor(Year), y = n, fill = factor(Year))) +
geom_col() +
labs(title = "Valid PM2.5 Observations by Year",
x = "Year", y = "Count") +
theme_minimal()
#### Basic summary ----
ca_data %>%
group_by(Year) %>%
summarize(
count = n(),
missing = sum(is.na(PM25)),
negative = sum(PM25 < 0, na.rm = TRUE),
mean = mean(PM25, na.rm = TRUE),
median = median(PM25, na.rm = TRUE),
sd = sd(PM25, na.rm = TRUE),
min = min(PM25, na.rm = TRUE),
max = max(PM25, na.rm = TRUE)
)
#### Summary of extreme values ----
ca_data %>%
filter(PM25 >= 0) %>%
group_by(Year) %>%
summarize(
above_35 = sum(PM25 > 35, na.rm = TRUE),
above_55 = sum(PM25 > 55, na.rm = TRUE),
above_100 = sum(PM25 > 100, na.rm = TRUE)
)
#### Monthly avgs ----
ca_data$Date <- as.Date(ca_data$Date)
ca_data$Month <- factor(format(ca_data$Date, "%m"),
levels = sprintf("%02d", 1:12),
labels = month.abb)
ca_data %>%
mutate(Date = as.Date(Date),
Month = factor(format(Date, "%m"),
levels = sprintf("%02d", 1:12),
labels = month.abb)) %>%
drop_na(PM25, Date) %>%
filter(PM25 >= 0) %>%
group_by(Year, Month) %>%
summarize(monthly_avg = mean(PM25), .groups = "drop") %>%
arrange(Year, Month) %>%
print(n = Inf)
#### Obs counts by year
ca_data %>%
filter(PM25 >= 0) %>%
count(Year)
#### Basic summary ----
ca_data %>%
group_by(Year) %>%
summarize(
count = n(),
missing = sum(is.na(PM25)),
negative = sum(PM25 < 0, na.rm = TRUE),
mean = mean(PM25, na.rm = TRUE),
median = median(PM25, na.rm = TRUE),
sd = sd(PM25, na.rm = TRUE),
min = min(PM25, na.rm = TRUE),
max = max(PM25, na.rm = TRUE)
)
#### Summary of extreme values ----
ca_data %>%
filter(PM25 >= 0) %>%
group_by(Year) %>%
summarize(
above_35 = sum(PM25 > 35, na.rm = TRUE),
above_55 = sum(PM25 > 55, na.rm = TRUE),
above_100 = sum(PM25 > 100, na.rm = TRUE)
)
#### Monthly avgs ----
ca_data$Date <- as.Date(ca_data$Date)
ca_data %>%
mutate(Date = as.Date(Date),
Month = factor(format(Date, "%m"),
levels = sprintf("%02d", 1:12),
labels = month.abb)) %>%
drop_na(PM25, Date) %>%
filter(PM25 >= 0) %>%
group_by(Year, Month) %>%
summarize(monthly_avg = mean(PM25), .groups = "drop") %>%
arrange(Year, Month) %>%
print(n = Inf)
#### Obs counts by year ----
ca_data %>%
filter(PM25 >= 0) %>%
count(Year)
# Filter for California counties only
county_data <- ca_data %>% filter(!is.na(County))
# Plot of PM2.5 by county by year
## Faceted line plot
combined_data$Date <- as.Date(combined_data$Date)
combined_data$Month <- as.numeric(format(combined_data$Date, "%m"))
ggplot(combined_data, aes(x = Month, y = PM25, group = Year, color = factor(Year))) +
stat_summary(fun = mean, geom = "line") +
stat_summary(fun = mean, geom = "point") +
facet_wrap(~County) +
labs(title = "Monthly PM2.5 Trend by County: 2002 vs 2022",
x = "Month", y = "Mean PM2.5", color = "Year") +
theme_minimal() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
text = element_text(size = 14),
legend.position = "bottom")
# Summary stats
#### Filter for California counties only
county_data <- ca_data %>% filter(!is.na(County))
#### Faceted line plot ----
combined_data$Date <- as.Date(combined_data$Date)
combined_data$Month <- as.numeric(format(combined_data$Date, "%m"))
ggplot(combined_data, aes(x = Month, y = PM25, group = Year, color = factor(Year))) +
stat_summary(fun = mean, geom = "line") +
stat_summary(fun = mean, geom = "point") +
facet_wrap(~County) +
labs(title = "Monthly PM2.5 Trend by County: 2002 vs 2022",
x = "Month", y = "Mean PM2.5", color = "Year") +
theme_minimal() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
text = element_text(size = 14),
legend.position = "bottom")
#### Ridgeline plot by country and year ----
combined_data %>%
filter(PM25 >= 0, !is.na(County)) %>%
ggplot(aes(x = PM25, y = County, fill = factor(Year))) +
geom_density_ridges(alpha = 0.6) +
labs(title = "PM2.5 Distribution by County",
x = "Daily PM2.5", y = "County", fill = "Year") +
theme_minimal()
#### Observation counts ----
combined_data %>%
filter(PM25 >= 0, !is.na(County)) %>%
count(County, Year) %>%
ggplot(aes(x = n, y = reorder(County, n), fill = factor(Year))) +
geom_col(position = "dodge") +
labs(title = "Observation Counts by County",
x = "Number of Observations", y = "County", fill = "Year") +
theme_minimal()
#### Basic by year ----
combined_data %>%
filter(!is.na(PM25), PM25 >= 0, !is.na(County)) %>%
group_by(County, Year) %>%
summarise(
count = n(),
mean = mean(PM25),
median = median(PM25),
sd = sd(PM25),
min = min(PM25),
max = max(PM25),
.groups = "drop"
) %>%
arrange(County, Year) %>%
print(n = Inf)
#### Extreme values by county ----
combined_data %>%
filter(!is.na(PM25), PM25 >= 0, !is.na(County)) %>%
group_by(County, Year) %>%
summarise(
above_35 = sum(PM25 > 35),
above_55 = sum(PM25 > 55),
above_100 = sum(PM25 > 100),
.groups = "drop"
) %>%
arrange(County, Year) %>%
print(n = Inf)
#### Obs count by county ----
combined_data %>%
filter(!is.na(PM25), PM25 >= 0, !is.na(County)) %>%
count(County, Year) %>%
pivot_wider(names_from = Year, values_from = n) %>%
arrange(County) %>%
print(n = Inf)
#### Basic by year ----
combined_data %>%
filter(!is.na(PM25), PM25 >= 0, !is.na(County)) %>%
group_by(County, Year) %>%
summarise(
count = n(),
mean = mean(PM25),
median = median(PM25),
sd = sd(PM25),
min = min(PM25),
max = max(PM25),
.groups = "drop"
) %>%
arrange(County, Year) %>%
print(n = Inf)
#### Extreme values by county ----
combined_data %>%
filter(!is.na(PM25), PM25 >= 0, !is.na(County)) %>%
group_by(County, Year) %>%
summarise(
above_35 = sum(PM25 > 35),
above_55 = sum(PM25 > 55),
above_100 = sum(PM25 > 100),
.groups = "drop"
) %>%
arrange(County, Year) %>%
print(n = Inf)
#### Obs count by county ----
combined_data %>%
filter(!is.na(PM25), PM25 >= 0, !is.na(County)) %>%
count(County, Year) %>%
pivot_wider(names_from = Year, values_from = n) %>%
arrange(County) %>%
print(n = Inf)
#### Filter for LA County
la_sites <- ca_data %>% filter(County == "Los Angeles")
la_data <- combined_data %>%
filter(County == "Los Angeles", PM25 >= 0, !is.na(Date))
#### Boxplot of PM2.5 by Year ----
ggplot(la_data, aes(x = factor(Year), y = PM25)) +
geom_boxplot(fill = "lightblue") +
labs(title = "PM2.5 Distribution in LA County: 2002 vs 2022",
x = "Year", y = "Daily PM2.5") +
theme_minimal()
#### Monthly Trend Line ----
la_data$Month <- factor(format(as.Date(la_data$Date), "%m"),
levels = sprintf("%02d", 1:12),
labels = month.abb)
ggplot(la_data, aes(x = Month, y = PM25, group = Year, color = factor(Year))) +
stat_summary(fun = mean, geom = "line", linewidth = 1) +
stat_summary(fun = mean, geom = "point", size = 2) +
labs(title = "Monthly PM2.5 in LA County: 2002 vs 2022",
x = "Month", y = "Mean PM2.5", color = "Year") +
theme_minimal()
#### Daily Time Series ----
ggplot(la_data, aes(x = as.Date(Date), y = PM25, color = factor(Year))) +
geom_line(alpha = 0.4) +
labs(title = "Daily PM2.5 in LA County",
x = "Date", y = "PM2.5", color = "Year") +
theme_minimal()
#### Obs count ----
la_data %>%
count(Year) %>%
ggplot(aes(x = factor(Year), y = n, fill = factor(Year))) +
geom_col() +
labs(title = "Valid PM2.5 Observations in LA County",
x = "Year", y = "Count") +
theme_minimal()
#### Daily Time Series ----
ggplot(la_data, aes(x = as.Date(Date), y = PM25, color = factor(Year))) +
geom_line(alpha = 0.4) +
labs(title = "Daily PM2.5 in LA County",
x = "Month (MM format)", y = "PM2.5", color = "Year") +
theme_minimal()
#### Filter for LA County
la_sites <- ca_data %>% filter(County == "Los Angeles")
la_data <- combined_data %>%
filter(County == "Los Angeles", PM25 >= 0, !is.na(Date))
#### Boxplot of PM2.5 by Year ----
ggplot(la_data, aes(x = factor(Year), y = PM25)) +
geom_boxplot(fill = "lightblue") +
labs(title = "PM2.5 Distribution in LA County: 2002 vs 2022",
x = "Year", y = "Daily PM2.5") +
theme_minimal()
#### Monthly Trend Line ----
la_data$Month <- factor(format(as.Date(la_data$Date), "%m"),
levels = sprintf("%02d", 1:12),
labels = month.abb)
ggplot(la_data, aes(x = Month, y = PM25, group = Year, color = factor(Year))) +
stat_summary(fun = mean, geom = "line", linewidth = 1) +
stat_summary(fun = mean, geom = "point", size = 2) +
labs(title = "Monthly PM2.5 in LA County: 2002 vs 2022",
x = "Month", y = "Mean PM2.5", color = "Year") +
theme_minimal()
#### Daily Time Series ----
ggplot(la_data, aes(x = as.Date(Date), y = PM25, color = factor(Year))) +
geom_line(alpha = 0.4) +
labs(title = "Daily PM2.5 in LA County",
x = "Month (MM format)", y = "PM2.5", color = "Year") +
theme_minimal()
#### Obs count ----
la_data %>%
count(Year) %>%
ggplot(aes(x = factor(Year), y = n, fill = factor(Year))) +
geom_col() +
labs(title = "Valid PM2.5 Observations in LA County",
x = "Year", y = "Count") +
theme_minimal()
## Summary stats ----
la_data <- combined_data %>%
filter(County == "Los Angeles", PM25 >= 0, !is.na(Date), !is.na(PM25))
#### Basic summary ----
la_data %>%
group_by(Year) %>%
summarise(
count = n(),
mean = mean(PM25),
median = median(PM25),
sd = sd(PM25),
min = min(PM25),
max = max(PM25),
.groups = "drop"
)
#### Extreme value counts ----
la_data %>%
group_by(Year) %>%
summarise(
above_35 = sum(PM25 > 35),
above_55 = sum(PM25 > 55),
above_100 = sum(PM25 > 100),
.groups = "drop"
)
#### Monthly averages ----
la_data %>%
mutate(Month = factor(format(as.Date(Date), "%m"),
levels = sprintf("%02d", 1:12),
labels = month.abb)) %>%
group_by(Year, Month) %>%
summarise(monthly_avg = mean(PM25), .groups = "drop") %>%
arrange(Year, Month) %>%
print(n = Inf)
#### Obs counts ----
la_data %>%
count(Year)
## Summary stats ----
la_data <- combined_data %>%
filter(County == "Los Angeles", PM25 >= 0, !is.na(Date), !is.na(PM25))
#### Basic summary ----
la_data %>%
group_by(Year) %>%
summarise(
count = n(),
mean = mean(PM25),
median = median(PM25),
sd = sd(PM25),
min = min(PM25),
max = max(PM25),
.groups = "drop"
)
#### Extreme value counts ----
la_data %>%
group_by(Year) %>%
summarise(
above_35 = sum(PM25 > 35),
above_55 = sum(PM25 > 55),
above_100 = sum(PM25 > 100),
.groups = "drop"
)
#### Monthly averages ----
la_data %>%
mutate(Month = factor(format(as.Date(Date), "%m"),
levels = sprintf("%02d", 1:12),
labels = month.abb)) %>%
group_by(Year, Month) %>%
summarise(monthly_avg = mean(PM25), .groups = "drop") %>%
arrange(Year, Month) %>%
print(n = Inf)
#### Obs counts ----
la_data %>%
count(Year)
# Dimensions
dim(data_2002)
dim(data_2022)
# Headers and footers
head(data_2002)
tail(data_2002)
head(data_2022)
tail(data_2022)
# Variable names and types
names(data_2002)
str(data_2002)
names(data_2022)
str(data_2022)
# Distribution of PM2.5
summary(data_2002$Daily.Mean.PM2.5.Concentration)
hist(data_2002$Daily.Mean.PM2.5.Concentration,
main = "PM2.5 Distribution - 2002",
xlab = "Daily Mean PM2.5",
col = "lightblue")
summary(data_2022$Daily.Mean.PM2.5.Concentration)
hist(data_2022$Daily.Mean.PM2.5.Concentration,
main = "PM2.5 Distribution - 2022",
xlab = "Daily Mean PM2.5",
col = "lightgreen")
# Histogram for 2022
ggplot(neg_2022, aes(x = Date)) +
geom_histogram(binwidth = 30, fill = "darkred", color = "white") +
labs(title = "Negative PM2.5 Values in 2022",
x = "Date", y = "Count") +
theme_minimal()
